{% extends "base.html" %}
{% block title %}Ø¯Ø§Ø´Ø¨ÙˆØ±Ø¯ Ù…Ø¯ÛŒØ±{% endblock %}
{% block content %}
<div class="d-flex justify-content-between align-items-center mb-4">
  <h4 class="mb-0">ğŸ“Š Ø¯Ø§Ø´Ø¨ÙˆØ±Ø¯ Ù…Ø¯ÛŒØ±</h4>
  <div>
    <a href="/admin/audit-logs" class="btn btn-outline-primary btn-sm">Ù…Ø´Ø§Ù‡Ø¯Ù‡ Ù„Ø§Ú¯â€ŒÙ‡Ø§</a>
    <a href="/admin/logout" class="btn btn-outline-danger btn-sm">Ø®Ø±ÙˆØ¬</a>
  </div>
</div>

<div class="row mb-4">
  <div class="col-md-4">
    <div class="card text-center shadow-sm border-primary">
      <div class="card-body">
        <h6 class="text-muted">ØªØ¹Ø¯Ø§Ø¯ Ú©Ø§Ø±Ø¨Ø±Ø§Ù†</h6>
        <h2 class="text-primary">{{ users|length }}</h2>
      </div>
    </div>

  </div>
  <div class="col-md-4">
    <div class="card text-center shadow-sm border-success">
      <div class="card-body">
        <h6 class="text-muted">Ú©Ù„ Ø±ÙˆÛŒØ¯Ø§Ø¯Ù‡Ø§</h6>
        <h2 class="text-success">{{ stats.total_logs }}</h2>
      </div>
    </div>
  </div>

  <div class="col-md-4">
    <div class="card text-center shadow-sm border-info">
      <div class="card-body">
        <h6 class="text-muted">Ù†ÙˆØ¹ Ø¹Ù…Ù„ÛŒØ§Øª Ø«Ø¨Øªâ€ŒØ´Ø¯Ù‡</h6>
        <h2 class="text-info">{{ stats.actions|length }}</h2>
      </div>
    </div>
  </div>
</div>

<div class="card mb-4 shadow-sm">
  <div class="card-header bg-primary text-white">ğŸ‘¥ Ù„ÛŒØ³Øª Ú©Ø§Ø±Ø¨Ø±Ø§Ù† Ø«Ø¨Øªâ€ŒØ´Ø¯Ù‡</div>
  <div class="card-body">
    <div class="table-responsive">
      <table class="table table-hover align-middle">
        <thead>
          <tr>
            <th>Ù†Ø§Ù…</th>
            <th>Ø´Ù…Ø§Ø±Ù‡ Ø¯Ø§Ù†Ø´Ø¬ÙˆÛŒÛŒ</th>
            <th>Ú©Ø¯ Ù…Ù„ÛŒ</th>
            <th>Ù†Ù‚Ø´</th>
            <th>ØªØ§Ø±ÛŒØ® Ø«Ø¨Øªâ€ŒÙ†Ø§Ù…</th>
            <th></th>
          </tr>
        </thead>
        <tbody>
          {% for user in users %}
          <tr>
            <td>{{ user.profile.first_name if user.profile else '-' }} {{ user.profile.last_name if user.profile else '' }}</td>
            <td>{{ user.student_number }}</td>
            <td>{{ user.profile.national_code if user.profile else '-' }}</td>
            <td><span class="badge bg-secondary">{{ user.role.name if user.role else '-' }}</span></td>
            <td>{{ user.created_at.strftime('%Y-%m-%d') if user.created_at else '-' }}</td>
            <td><a class="btn btn-sm btn-outline-primary" href="/admin/users/{{ user.id }}">Ø¬Ø²Ø¦ÛŒØ§Øª</a></td>
          </tr>
          {% else %}
          <tr>
            <td colspan="6" class="text-center text-muted">Ú©Ø§Ø±Ø¨Ø±ÛŒ ÛŒØ§ÙØª Ù†Ø´Ø¯.</td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
  </div>
</div>

<div class="card shadow-sm">
  <div class="card-header bg-light">â° Ø¢Ø®Ø±ÛŒÙ† Ù„Ø§Ú¯â€ŒÙ‡Ø§</div>
  <div class="card-body">
    <div class="table-responsive">
      <table class="table table-sm">
        <thead>
          <tr>
            <th>Ø²Ù…Ø§Ù†</th>
            <th>Ú©Ø§Ø±Ø¨Ø±</th>
            <th>Ø¹Ù…Ù„ÛŒØ§Øª</th>
            <th>ØªÙˆØ¶ÛŒØ­Ø§Øª</th>
          </tr>
        </thead>
        <tbody>
          {% for log in recent_logs %}
          <tr>
            <td>{{ log.created_at.strftime('%Y-%m-%d %H:%M:%S') if log.created_at else '-' }}</td>
            <td>{{ log.user_id or '-' }}</td>
            <td>{{ log.action }}</td>
            <td>{{ log.description or '-' }}</td>
          </tr>
          {% else %}
          <tr>
            <td colspan="4" class="text-center text-muted">Ù„Ø§Ú¯ÛŒ Ø«Ø¨Øª Ù†Ø´Ø¯Ù‡ Ø§Ø³Øª.</td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
  </div>
</div>

{% endblock %}